<!--<!DOCTYPE html>
<html lang="en">-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:th="http://www.w3.org/1999/xhtml" >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" charset="UTF-8">
    <title>博客详情</title>
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
    <link rel="stylesheet" th:href="@{/lib/editormd/css/style.css}" />
    <link rel="stylesheet" th:href="@{/lib/editormd/css/editormd.preview.css}" />
    <link rel="stylesheet" href="../css/typo.css">
    <link rel="stylesheet" href="../css/animate.css">
    <link rel="stylesheet" href="../css/me.css">
    <link rel="stylesheet" href="../lib/prism/prism.css">
    <link rel="stylesheet" href="../lib/tocbot/tocbot.css">
    <script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery.scrollto@2.1.2/jquery.scrollTo.min.js"></script>
    <script type="text/javascript" th:src="@{/lib/qrcode/qrcode.min.js}"></script>
    <script th:src="@{/lib/waypoint/jquery.waypoints.min.js}"></script>
    <link rel="stylesheet" th:href="@{/lib/editormd/css/editormd.min.css}"/>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/jquery.flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/marked.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/prettify.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/raphael.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/sequence-diagram.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/underscore.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/editormd.js}"></script>
    <script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>-->
    <!--<script src="https://cdn.jsdelivr.net/npm/jquery.scrollto@2.1.2/jquery.scrollTo.min.js"></script>-->
    <!--引入js文件-->

    <script type="text/javascript" th:src="@{/lib/qrcode/qrcode.min.js}"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
    <link rel="stylesheet" th:href="@{/css/typo.css}">
    <link rel="stylesheet" th:href="@{/css/animate.css}">
    <link rel="stylesheet" th:href="@{/css/me.css}">
    <link rel="stylesheet" th:href="@{/lib/prism/prism.css}">
    <link rel="stylesheet" th:href="@{/lib/tocbot/tocbot.css}">
    <link rel="stylesheet" th:href="@{/lib/editormd/css/editormd.preview.css}" />
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/marked.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/prettify.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/raphael.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/underscore.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/sequence-diagram.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/flowchart.min.js}"></script>
    <script th:src="@{/lib/editormd/lib/jquery.flowchart.min.js}"></script>
    <script th:src="@{/lib/editormd/editormd.js}"></script>
    <!--<script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/jquery.scrollto@2.1.2/jquery.scrollTo.min.js"></script>
    <script th:src="@{/lib/waypoint/jquery.waypoints.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.js"></script>
    <script th:src="@{/lib/prism/prism.js}"></script>
    <script th:src="@{/lib/tocbot/tocbot.min.js}"></script>

</head>
<!--<head th:include="_fragments :: head(title='博客详情')">
    <link rel="stylesheet" th:href="editor.md-master/css/editormd.min.css"/>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/jquery.flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/marked.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/prettify.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/raphael.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/sequence-diagram.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/underscore.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/flowchart.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/jquery.js}"></script>
    <script type="text/javascript" th:src="@{/lib/editormd/lib/editormd.js}"></script>
    <script src="http://strapdownjs.com/v/0.2/strapdown.js"></script>
</head>-->
<body>
<!--导航-->
<nav th:include="_fragments :: menu(n=-1)" class="ui inverted attached segment m-padded-tb-mini m-shadow-small"></nav>
<!--<nav class="ui inverted attached segment m-padded-tb-mini m-shadow-small">
    <div class="ui container">
        <div class="ui inverted secondary stackable menu ">
            <h2 class="ui teal header item">Blog</h2>
            <a href="#" class="m-item item m-mobile-hide"><i class="home icon"></i>首页</a>
            <a href="#" class="m-item item m-mobile-hide"><i class="idea icon"></i>分类</a>
            <a href="#" class="m-item item m-mobile-hide"><i class="tags icon"></i>标签</a>
            <a href="#" class="m-item item m-mobile-hide"><i class="clone icon"></i>归档</a>
            <a href="#" class="m-item item m-mobile-hide"><i class="info icon"></i>关于我</a>
            <div class="m-item right item m-mobile-hide">
                <div class="ui icon inverted transparent input">
                    <input type="text" placeholder="Search...">
                    <i class="search link icon"></i>
                </div>

            </div>
        </div>
    </div>
    <a href="#" class="ui menu toggle icon button m-right-top m-mobile-show">
        <i class="sidebar icon"></i>
    </a>
</nav>-->
<!--中间内容-->
<div id="waypoint" class="m-padded-tb-large m-container m-padded-tb-big animated fadeIn">
    <div class="ui container">
        <div class="ui top attached segment">
            <div class="ui  horizontal  link list">
                <div class="item">
                    <img src="../images/Headportrait.jpg" alt="" class="ui avatar image">
                    <div class="content"><a href="#" class="header">白峰源</a></div>
                </div>

                <div class="item">
                    <i class="calendar icon"></i>[[${blog.updateTime}]]
                </div>
                <div class="item">
                    <i class="eye icon"></i> [[${blog.views}]]
                </div>
                <!--<div class="item">
                    <i class="eye icon"></i>[[${blog.views}]]
                </div>-->

            </div>
        </div>
        <div class="ui attached segment">
            <img th:src="${blog.firstPicture}" alt="" class="ui fluid image">
        </div>
        <div class="ui  attached padded segment">
            <!--内容-->
            <div class="ui right aligned basic segment">
                <div class="ui orange basic label" th:text="${blog.flag}">原创</div>
            </div>
            <h2 class="ui center aligned header" th:text="${blog.title}">关于刻意练习的清单</h2>

            <textarea id="conten" name="textContentf" style="display: none" th:text="${blog.content}">
                </textarea>
            <div id="content" class="typo typo-selection js-toc-content m-padded-lr-responsive m-padded-tb-large"><!--class="typo typo-selection js-toc-content m-padded-lr-responsive m-padded-tb-large" -->
                <textarea id="blogcontent" name="textContent" style="display:none;">
                </textarea>

            </div>
            <!--标签-->
            <div class="m-padded-lr-responsive m-padded-top">
                <a class="ui basic teal left pointing label" th:each="tag:${blog.tags}" th:text="${tag.name}" th:href="'/tag/1/10/true/'+${tag.id}">方法论</a>
            </div>
            <!--赞赏-->
            <div class="ui center aligned basic segment" th:if="${blog.appreciation==true}">
                <button id="payButton" class="ui basic circular orange button" >赞赏</button>
            </div>

            <div class="ui payQ flowing popup transition hidden" >
                <div class="ui orange basic label">
                    <div class="ui images" style="font-size: inherit">
                        <div class="image">
                            <img th:src="@{/images/alipay.png}" alt="" class="ui rounded border image" style="width: 120px">
                            <div>支付宝</div>
                        </div>
                        <div class="image">
                            <img th:src="@{/images/wechatpay.png}" alt="" class="ui rounded border image" style="width: 120px">
                            <div>微信</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="ui attached positive message">
            <!--博客信息-->
            <div class="ui middle aligned grid">
                <div class="eleven wide column">
                    <ui class="list">
                        <li>作者:白峰源(联系作者)</li>
                        <li>发表时间:<span th:text="${blog.createTime}">2020-01-13</span></li>
                        <li>版权声明:自由转载-非商用-非衍生-保持署名(创意共享3.8许可证)</li>
                        <li>公众号转载:请在文末添加作者公众号二维码</li>
                    </ui>
                </div>
                <div class="five wide column">
                    <img src="../images/wechat.jpg" alt="" class="ui right floated roundedbordered image" style="width: 110px">
                </div>
            </div>
        </div>
        <div th:if="${blog.commentable==true}" id="comment-container" class="ui bottom attached segment">
            <!--留言区域列表-->
            <div class="ui teal segment">
                <div class="ui comments">
                    <h3 class="ui dividing header">Comments</h3>



                    <div class="comment" th:each="comment:${blog.comments}">
                        <a class="avatar">
                            <img src="../images/elliot.jpg">
                        </a>
                        <div class="content">
                            <a class="author" th:text="${comment.nickname}">Matt</a>
                            <div class="metadata">
                                <span class="date" th:text="${#dates.format(comment.createTime, 'yyyy-MM-dd : HH:mm:ss')}">Today at 5:42PM</span>
                            </div>
                            <div class="text" th:text="${comment.avatar}">
                                How artistic!
                            </div>
                            <div class="actions">
                                <a class="reply" th:onclick="addReply([[${comment.id}]],[[${comment.nickname}]]);">回复</a>
                            </div>
                        </div>

                        <div class="comments" th:each="replycomment:${comment.replyComments}">
                            <div class="comment">
                                <a class="avatar">
                                    <img src="../images/joe.jpg">
                                </a>
                                <div class="content">
                                    <a class="author" th:text="${replycomment.nickname}">Jenny Hess</a>
                                    <div class="metadata">
                                        <span class="date" th:text="${#dates.format(replycomment.createTime, 'yyyy-MM-dd : HH:mm:ss')}">Just now</span>
                                    </div>
                                    <div class="text" th:text="${replycomment.avatar}">
                                        Elliot you are always so right :)
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>


                    </div>

                </div>


            <div class="ui form">
                <div class="field">
                    <textarea id="commenttext" name="content" placeholder="请输入评论信息" cols="30" rows="10" th:blogid="${blog.id}"></textarea>
                </div>

                <div class="fields">
                <div class="field m-mobile-wide m-margin-bottom-small">
                    <div class="ui left icon input">
                        <i class="user icon"></i>
                    <input type="text" id="nickname" name="nickname" placeholder="姓名">
                    </div>
                </div>
                    <div class="field m-mobile-wide m-margin-bottom-small">
                        <div class="ui left icon input">
                            <i class="mail icon"></i>
                            <input type="text" id="email" name="email" placeholder="邮箱">
                        </div>
                    </div>
                    <div class="field m-mobile-wide m-margin-bottom-small">
                        <button class="ui teal button m-mobile-wide" th:onclick="reply()"><i class="edit icon"></i>发布</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="m-padded m-right-bottom m-fixed">
<div class="ui vertical icon buttons ">
    <a href="#comment-container" type="button" class="ui teal button">留言</a>
<!--    <button class="ui wechat icon button"><i class="weixin icon"></i></button>-->
    <button id="toTop-button" class="ui icon button"><i class="chevron up icon"></i></button>
</div>
</div>


<div class="ui toc-container flowing popup transition hidden" style="width: 250px !important;">

    <ol class="js-toc">

    </ol>
</div>


<div id="qrcode" class="ui wechat-qr flowing popup transition hidden "style="width: 130px !important;">

</div>



<!--底部footer-->
<footer class="ui inverted vertical segment m-padded-tb-massive">
    <div class="ui center aligned container">
        <div class="ui inverted divided stackable grid">
            <div class="three wide column">
                <div class="ui inverted link list">
                <div class="item">
                <img src="../images/wechat.jpg" class="ui rounded image" style="width: 120px">
                </div>
                </div>
            </div>
            <div class="three wide column">
                <h4 class="m-text-thin m-text-spaced">最新博客</h4>
                <div class="ui inverted link list">
                    <a href="#" class="item">用户故事(User Story)</a>
                    <a href="#" class="item">用户故事(User Story)</a>
                    <a href="#" class="item">用户故事(User Story)</a>
                    <a href="#" class="item">用户故事(User Story)</a>
                </div>
            </div>
            <div class="three wide column">
                <h4 class="m-text-thin m-text-spaced">联系我</h4>
                <div class="ui inverted link list">
                    <a href="#" class="item">Email:377092613@qq.com</a>
                    <a href="#" class="item">QQ:377092613</a>
                </div>
            </div>
            <div class="seven wide column">
                <h4 class="m-text-thin m-text-spaced">关于我</h4>
                <P class="m-text-thin m-text-spaced m-opacity-mini">一个热爱生活，热爱思考，专心编程的程序猿，这是我的个人博客，我希望能够通过博客记录自己学习的点点滴滴</P>
            </div>
        </div>
        <div class="ui inverted section divider"></div>
        <p class="m-text-thin m-text-spaced m-opacity-mini">Copyright©2020 Designed by Baifengyuan</p>
    </div>

</footer>


<script>
   function reply(){
       var replytext=$("#commenttext").val();
       var flagtest=replytext.substring(0,2);
       var flag=flagtest.indexOf("回复");
       if(flag==-1){
           $("#commenttext").attr("commentid",null);
       }

       $.ajax({
           type: "POST",
           url: "/addComment",
           data: {nickname:$("#nickname").val(), email:$("#email").val(),avatar:replytext,blogid:$("#commenttext").attr("blogid"),commentid:$("#commenttext").attr("commentid")},
           dataType: "json",
           success: function(data){
               location.reload()
           },
             error:function(e){
                 $("#commenttext").val('');
                 location.reload()
             }
   });

   }

   function addReply(commentid,nickname){
        $("#commenttext").val("回复"+nickname+":");
       $("#commenttext").attr('commentid',commentid);
   }
    /*var testEditor;
    $(function () {
        testEditor = editormd.markdownToHTML("content", {//注意：这里是上面DIV的id
            htmlDecode: "style,script,iframe",
            emoji: true,
            taskList: true,
            tex: true, // 默认不解析
            flowChart: true, // 默认不解析
            sequenceDiagram: true, // 默认不解析
            codeFold: true,
        });});*/

    $(function() {
        $("#content").html('<textarea id="blogcontent" name="textContent" style="display:none;"></textarea>');
        var content=$("#conten").val();//获取需要转换的内容
        $("#blogcontent").val(content);//将需要转换的内容加到转换后展示容器的textarea隐藏标签中
        var testEditormdView;
        testEditormdView = editormd.markdownToHTML("content", {
            htmlDecode      : "style,script,iframe",  // you can filter tags decode
            emoji           : true,
            taskList        : true,
            tex             : true,  // 默认不解析
            flowChart       : true,  // 默认不解析
            sequenceDiagram : true,  // 默认不解析
        });
    })

    $('.menu.toggle').click(function(){
        $('.m-item').toggleClass('m-mobile-hide');
    });

    $('#payButton').popup({
        popup : $('.payQ.popup'),
        on : 'click',
        position : 'bottom center'
    });

    tocbot.init({
        // Where to render the table of contents.
        tocSelector: '.js-toc',
        // Where to grab the headings to build the table of contents.
        contentSelector: '.js-toc-content',
        // Which headings to grab inside of the contentSelector element.
        headingSelector: 'h1, h2, h3',
        // For headings inside relative or absolute positioned containers within content.
        hasInnerContainers: true,
    });

    $('.toc.button').popup({
        popup : $('.toc-container.popup'),
        on : 'click',
        position : 'left center'
    });

    $('.wechat').popup({
        popup : $('.wechat-qr'),
        position : 'left center'
    });

    var qrcode = new QRCode("qrcode", {
        text: "http://jindo.dev.naver.com/collie",
        width: 100,
        height: 100,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });

    $('#toTop-button').click(function () {
        $(window).scrollTo(0,500);
    });



    var waypoint = new Waypoint({
        element: document.getElementById('waypoint'),
        handler: function(direction) {
            if (direction == 'down') {
                $('#toolbar').show(100);
            } else {
                $('#toolbar').hide(500);
            }
            console.log('Scrolled to waypoint!  ' + direction);
        }
    });



</script>



</body>
</html>